<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Map-Box-API</title>
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.css' rel='stylesheet'/>
</head>
<body>
<h1>Map Box API</h1>


<div id='map' style='width: 400px; height: 300px;'></div>
<button id="zoom-in" type="button">Zoom In</button>
<button id="zoom-out" type="button">Zoom Out</button>


<script src="https://code.jquery.com/jquery-3.6.4.min.js"
        integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
<script>
    accessToken = 'pk.eyJ1IjoiYXVzdGluajk1IiwiYSI6ImNsZXp6Mnl1ejAwdmIzdG1ra3FkNHdzdXoifQ.PMmC9psSUgno2UcUPJEWdw'
    mapboxgl.accessToken = accessToken;
    const map = new mapboxgl.Map({
        container: 'map', // container ID
        style: 'mapbox://styles/mapbox/streets-v12', // style URL
        center: [-84.2807, 30.4383], // starting position [lng, lat]
        zoom: 20, // starting zoom
    });

    // this geocodes the given address which means by string name ex: tallahassee console logs tallahassee coordinates.
    function geocode(search, token) {
        var baseUrl = 'https://api.mapbox.com';
        var endPoint = '/geocoding/v5/mapbox.places/';
        return fetch(baseUrl + endPoint + encodeURIComponent(search) + '.json' + "?" + 'access_token=' + token)
            .then(function (res) {
                return res.json();
                // to get all the data from the request, comment out the following three lines...
            }).then(function (data) {
                return data.features[0].center;
            });
    }

    geocode("Tallahassee, FL", mapboxgl.accessToken).then(function (result) {
        console.log(result);
        map.setCenter(result.center);
        map.setZoom(10);
    });

    var alamoInfo = {
        address: "2915 Kerry Forest Pkwy #301, Tallahassee, FL 32309",

    };

    function placeMarkerAndPopup(info, token, map) {
        geocode(info.address, token).then(function(coordinates) {


            var marker = new mapboxgl.Marker()
                .setLngLat(coordinates)
                .addTo(map)
                .setPopup(popup);
            popup.addTo(map);
        });
    }

    placeMarkerAndPopup(alamoInfo, accessToken, map);
    //reverse geocode for using given coordinates to console log string of place.
    // function reverseGeocode(coordinates, token) {
    //     var baseUrl = 'https://api.mapbox.com';
    //     var endPoint = '/geocoding/v5/mapbox.places/';
    //     return fetch(baseUrl + endPoint + coordinates.lng + "," + coordinates.lat + '.json' + "?" + 'access_token=' + token)
    //         .then(function (res) {
    //             return res.json();
    //         })
    //         .then(function(data) {
    //             return data.features[0].place_name;
    //         });
    // }
    //
    // reverseGeocode({lng: -84.280933
    //     , lat: 30.438083}, accessToken).then(function(results) {
    //     // logs the address for Favorite restaurant
    //     console.log(results);
    //     map.setCenter(results.place_name);
    //     map.setZoom(10);
    // });

    $('#zoom-in').click(function () {
        let zoom = map.getZoom();
        if (zoom < 20) {
            map.setZoom(zoom + 1);
            console.log("You Zoomed in to level: " + (parseInt(zoom) + 1));
        } else {
            alert("You are zoomed in all the way!")

        }
    });
    $('#zoom-out').click(function () {
        let zoom = map.getZoom();

        if (zoom > 1) {
            map.setZoom(zoom - 1);
            console.log("You Zoomed out to level: " + (parseInt(zoom) + -1));
        } else {
            alert("You are zoomed in all the way!")
        }
    });


</script>
</body>
</html>